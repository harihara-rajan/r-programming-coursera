getwd()
setwd("/home/hari-cms/r-programming-coursera/week2")
pollutantmean<- function(directory, pollutant, id){
## 'directory' is a character vector of length 1 indicating
## the location of the CSV files
## 'pollutant' is a character vector of length 1 indicating
## the name of  the pollutant for which we will calcultate the
## mean; either "sulfate" or "nitrate"
## 'id' is an integer vector indicating the monitor ID numbers
## to be used
## Return the mean of the pollutant across all monitors list
## in the 'id' vector (ignoring NA values)
## NOTE: Do not round the result
count = 1                             # counter like variable
temp2 <- numeric()                     # empty vector for storing the mean value of each monitor id
for (monitor in id){
path <- paste(getwd(),"/", directory,"/",sprintf("%03d",monitor ),".csv",sep = "")
data <- read.csv(path)              # data frame
need <- data[pollutant]            # extracting only data that is of interest
bad <- is.na(need)
useful_data <- need[!bad]
for (i in useful_data){
temp2[count] <- i
count <- count + 1
}
}
mean(temp2)
}
corr <- function(directory,threshold=0){
## 'directory' is a character vector of length 1 indicating
## the location of the CSV files
## threshold is a numeric vector of  length 1 indicating the
##number of completely observed observation (on all
## variables) required to complete the correlation between
## nitrate and sulfate; the default value is 0.
count <- 1
id = 1:332
need <- numeric(length(id))
cr <- vector()
for (monitor in id)
{
path <- paste(getwd(),"/", directory,"/",sprintf("%03d",monitor) ,".csv",sep = "")
dataf <- read.csv(path)
data_sulfate <- dataf[,"sulfate"]
data_nitrate <- dataf[,"nitrate"]
a <- complete.cases(data_nitrate,data_sulfate)
good_sulfate <- data_sulfate[a]
good_nitrate <- data_nitrate[a]
if (length(good_sulfate)>threshold)
{
crel <- cor(good_sulfate, good_nitrate)
cr[count] <- crel
count <- count + 1
}
}
final <- cr
final
}
complete <- function(directory, id){
## 'directory' is a character vector of length 1 indicating
## the location of the CSV files
## 'id' is an integer vector indicating the monitor ID numbers
## to be used
## it should be noted that when data for sulfate is present,
## then we will have data for nitrate as well and therefore
## we can take any one value between nitrate and sulfate.
count <- 1
nobs <- numeric(length(id))
for (monitor in id){
path <- paste(getwd(),"/", directory,"/",sprintf("%03d",monitor) ,".csv",sep = "")
dataf <- read.csv(path)
data_nitrate <- dataf[,"nitrate"]
data_sulfate <- dataf["sulfate"]
good <- complete.cases(data_nitrate,data_sulfate)
nobs[count] <- length(data_nitrate[good])
count <- count + 1
}
c <- data.frame(id,nobs)
c
}
pollutantmean("specdata", "nitrate", 70:72)
complete("specdata", c(2, 4, 8, 10, 12))
cr <- corr("specdata", 150)
head(cr)
